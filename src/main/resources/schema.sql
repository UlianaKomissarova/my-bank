DROP TABLE IF EXISTS users CASCADE;
DROP TABLE IF EXISTS emails CASCADE;
DROP TABLE IF EXISTS phones CASCADE;
DROP TABLE IF EXISTS accounts CASCADE;

CREATE TABLE IF NOT EXISTS users (
	user_id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	full_name VARCHAR(250),
	login VARCHAR(100) UNIQUE NOT NULL,
	password VARCHAR(250) NOT NULL,
	birthday TIMESTAMP,
	CONSTRAINT pk_users PRIMARY KEY (user_id)
);

CREATE TABLE IF NOT EXISTS emails (
	user_id BIGINT NOT NULL REFERENCES users(user_id),
	email VARCHAR(250) UNIQUE NOT NULL,
	CONSTRAINT pk_user_emails PRIMARY KEY (user_id, email)
);

CREATE TABLE IF NOT EXISTS phones (
	user_id BIGINT NOT NULL REFERENCES users(user_id),
	phone VARCHAR(250) UNIQUE NOT NULL,
	CONSTRAINT pk_user_phones PRIMARY KEY (user_id, phone)
);

CREATE TABLE IF NOT EXISTS accounts (
	account_id BIGINT NOT NULL,
	init_balance BIGINT NOT NULL,
	balance BIGINT,
	CONSTRAINT pk_accounts PRIMARY KEY (account_id),
    CONSTRAINT fk_account_user FOREIGN KEY (account_id) REFERENCES users(user_id)
);

